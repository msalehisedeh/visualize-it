!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("@sedeh/visualize-it",["exports","@angular/core","@angular/common"],n):n(((e=e||self).sedeh=e.sedeh||{},e.sedeh["visualize-it"]={}),e.ng.core,e.ng.common)}(this,(function(e,n,t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function o(e,n,t,o){var r,i=arguments.length,s=i<3?n:null===o?o=Object.getOwnPropertyDescriptor(n,t):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,n,t,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(n,t,s):r(n,t))||s);return i>3&&s&&Object.defineProperty(n,t,s),s}function r(e,n){var t,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=n.call(e,s)}catch(e){i=[6,e],o=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}var i=function(){function e(e){var t=this;this.factory=e,this.showLegend=!1,this.showHelp=!1,this.expanded=!1,this.visualizerId="d3-container",this.gradientsEnabled=!0,this.repealForce=300,this.fixedDistance=60,this.typeMapping={},this.onVisualization=new n.EventEmitter,this.renderer=this.factory.createRenderer(null,null),navigator.platform.toUpperCase().indexOf("MAC")<0&&(document.addEventListener("webkitfullscreenchange",(function(e){window.screenTop||window.screenY||t.expand(!1)})),document.addEventListener("mozfullscreenchange",(function(e){var n=window;n.fullScreen||n.innerWidth==screen.width&&n.innerHeight==screen.height||t.expand(!1)})),document.addEventListener("MSFullscreenChange",(function(e){var n=window;n.fullScreen||n.innerWidth==screen.width&&n.innerHeight==screen.height||t.expand(!1)})))}return e.prototype.triggerEvaluation=function(e){if(e.length){var n={},t=[],o={links:[],nodes:[]};if(this.renderer.selectRootElement("#"+this.visualizerId).innerHTML="",e.map((function(e,t){return n[e.id]=t})),e.map((function(e,r){o.nodes.push({size:e.size?e.size:10,group:e.group?e.group:0,type:e.type&&e.type.length?e.type:"circle",name:e.name,image:e.image,data:e.data?e.data:[]}),e.sources&&e.sources.map((function(i){var s=n[i];null!=s?o.links.push({source:s,target:r}):t.push("Missing source node '"+i+"' for node '"+e.id+"'.")})),e.destinations&&e.destinations.map((function(i){var s=n[i];null!=s?o.links.push({source:r,target:s}):t.push("Missing destination node '"+i+"' for node '"+e.id+"'.")}))})),t.length)this.renderer.selectRootElement("#"+this.visualizerId).innerHTML="<div class='danger'>"+t.join("<br/>")+"</div>";else{var r=this.renderer.selectRootElement("#"+this.visualizerId).parentNode,i={width:window.innerWidth,height:window.innerHeight,offset:{x:r.offsetLeft,y:r.offsetTop},data:o,mapping:this.typeMapping,showTypeOnHover:this.showTypeOnHover,showDirections:this.showDirections,enableTooltip:this.enableTooltip,showCurvedConnections:this.showCurvedConnections,outlineNodes:this.outlineNodes,charge:-1*this.repealForce,fixedDistance:this.fixedDistance,gradientsEnabled:this.gradientsEnabled,targetDiv:"#"+this.visualizerId};window.initiateD3(i)}}else this.renderer.selectRootElement("#"+this.visualizerId).innerHTML="<div class='danger'>Missing data.</div>"},e.prototype.ngOnChanges=function(e){e.data&&setTimeout(this.ngOnInit.bind(this),333)},e.prototype.ngOnInit=function(){this.data instanceof Array||(this.data=[this.data])},e.prototype.ngAfterViewInit=function(){return e=this,n=void 0,o=function(){var e=this;return r(this,(function(n){switch(n.label){case 0:return window.initiateD3?[3,2]:[4,this.loadScript("assets/d3.js","d3js").then((function(){e.triggerEvaluation(e.data)}))];case 1:return n.sent(),[3,3];case 2:this.triggerEvaluation(this.data),n.label=3;case 3:return[2]}}))},new((t=void 0)||(t=Promise))((function(r,i){function s(e){try{p(o.next(e))}catch(e){i(e)}}function a(e){try{p(o.throw(e))}catch(e){i(e)}}function p(e){e.done?r(e.value):new t((function(n){n(e.value)})).then(s,a)}p((o=o.apply(e,n||[])).next())}));var e,n,t,o},e.prototype.loadScript=function(e,n){return new Promise((function(n,t){var o=document.createElement("script");o.type="text/javascript",o.src=e,o.onload=n,document.body.appendChild(o)}))},e.prototype.expand=function(e){var n=document;if(e){var t=this.renderer.selectRootElement("#"+this.visualizerId).parentNode,o=n.documentElement;o.requestFullscreen?o.requestFullscreen():o.mozRequestFullScreen?o.mozRequestFullScreen():o.webkitRequestFullscreen?o.webkitRequestFullscreen():o.msRequestFullscreen&&o.msRequestFullscreen(),t.classList.add("expanded-container"),this.expanded=!0,window.centerVisibility&&window.centerVisibility(0,0)}else{n.exitFullscreen?n.exitFullscreen():n.mozCancelFullScreen?n.mozCancelFullScreen():n.webkitExitFullscreen&&n.webkitExitFullscreen(),(t=this.renderer.selectRootElement("#"+this.visualizerId).parentNode).classList.remove("expanded-container"),this.expanded=!1,window.centerVisibility&&window.centerVisibility(t.offsetLeft,t.offsetTop)}},e.prototype.onchange=function(e){this.triggerEvaluation(e.points)},e.ctorParameters=function(){return[{type:n.RendererFactory2}]},o([n.Input("showCurvedConnections")],e.prototype,"showCurvedConnections",void 0),o([n.Input("visualizerId")],e.prototype,"visualizerId",void 0),o([n.Input("enableTooltip")],e.prototype,"enableTooltip",void 0),o([n.Input("gradientsEnabled")],e.prototype,"gradientsEnabled",void 0),o([n.Input("repealForce")],e.prototype,"repealForce",void 0),o([n.Input("fixedDistance")],e.prototype,"fixedDistance",void 0),o([n.Input("outlineNodes")],e.prototype,"outlineNodes",void 0),o([n.Input("enableLegends")],e.prototype,"enableLegends",void 0),o([n.Input("showTypeOnHover")],e.prototype,"showTypeOnHover",void 0),o([n.Input("showDirections")],e.prototype,"showDirections",void 0),o([n.Input("data")],e.prototype,"data",void 0),o([n.Input("typeMapping")],e.prototype,"typeMapping",void 0),o([n.Input("width")],e.prototype,"width",void 0),o([n.Input("height")],e.prototype,"height",void 0),o([n.Output("onVisualization")],e.prototype,"onVisualization",void 0),e=o([n.Component({selector:"visualize-it",template:'\r\n<div class="legends" *ngIf="enableLegends">\r\n    <a tabindex="0" (click)="showLegend = !showLegend;showHelp = false" title="show Legend"><span class="legend">&#9826;</span></a>\r\n    \r\n    <a *ngIf="!expanded" tabindex="0" (click)="expand(true)" title="show in full screen"><span class="expand">&#9859;</span></a>\r\n    <a *ngIf="expanded" tabindex="0" (click)="expand(false)" title="show in normal screen"><span class="expand">&#9860;</span></a>\r\n    \r\n    <a tabindex="0" (click)="showLegend = false;showHelp = !showHelp" title="show help"><span class="help">?</span></a>\r\n    <fieldset class="info" *ngIf="showLegend">\r\n        <legend>Definitions</legend>\r\n        <b>Relationship types:</b><br/>\r\n        <strong>Dotted line:</strong> Descendancy relationship (example: Children of)<br/>\r\n        <strong>Solid Line:</strong> Origination relationship (example: Parents of)<br/>\r\n        <span *ngIf="showDirections"><strong>Arrow on a line:</strong> Pointing toward the recipient of relationship.<br/></span>\r\n\r\n        <br/><b>Node types:</b><br/>\r\n        <span *ngIf="typeMapping[\'circle\']"><strong>Circle</strong> - {{typeMapping[\'circle\']}}<br/></span>\r\n        <span *ngIf="typeMapping[\'cross\']"><strong>Cross</strong> - {{typeMapping[\'cross\']}}<br/></span>\r\n        <span *ngIf="typeMapping[\'diamond\']"><strong>Diamond</strong> - {{typeMapping[\'diamond\']}}<br/></span>\r\n        <span *ngIf="typeMapping[\'square\']"><strong>Square</strong> - {{typeMapping[\'square\']}}<br/></span>\r\n        <span *ngIf="typeMapping[\'triangle-down\']"><strong>Triangle-down</strong> - {{typeMapping[\'triangle-down\']}}<br/></span>\r\n        <span *ngIf="typeMapping[\'triangle-up\']"><strong>Triangle-up</strong> - {{typeMapping[\'triangle-up\']}}<br/></span>\r\n    </fieldset>\r\n    <fieldset class="info" *ngIf="showHelp">\r\n        <legend>Tips</legend>\r\n        <b>Hover on a node to highlight 1st-order neighbourhood.</b><br/>\r\n        <b>Hold mouse down on a node to fade surroundings.</b><br/>\r\n        <b>Double-click to center node and zoom in.</b><br/>\r\n        <b>Hold SHIFT and Double-click to zoom out.</b><br/><br/>\r\n\r\n        <b>Filter nodes by:</b><br/>\r\n        <strong>"." :</strong> Stop/resume animation<br/>\r\n        <strong>"!" :</strong> Show/hide node category on hover<br/>\r\n        <strong>"#" :</strong> Show/hide link arrow direction<br/>\r\n        <strong>"@" :</strong> Show/hide node names or node category<br/>\r\n        <strong>"T" :</strong> Enable/disable displaying of Tooltip<br/>\r\n        <strong>"Z" :</strong> Do/Don\'t Normalize node sizes on zoom<br/>\r\n        <span *ngIf="typeMapping[\'circle\']"><strong>"C" :</strong> Show/hide all circle ( {{typeMapping[\'circle\']}} ) nodes<br/></span>\r\n        <span *ngIf="typeMapping[\'cross\']"><strong>"X" :</strong> Show/hide all cross ( {{typeMapping[\'cross\']}} ) nodes<br/></span>\r\n        <span *ngIf="typeMapping[\'diamond\']"><strong>"R" :</strong> Show/hide all diamond ( {{typeMapping[\'diamond\']}} ) nodes<br/></span>\r\n        <span *ngIf="typeMapping[\'square\']"><strong>"S" :</strong> Show/hide all square ( {{typeMapping[\'square\']}} ) nodes<br/></span>\r\n        <span *ngIf="typeMapping[\'triangle-down\']"><strong>"D" :</strong> Show/hide all triangle-down ( {{ typeMapping[\'triangle-down\']}} ) nodes<br/></span>\r\n        <span *ngIf="typeMapping[\'triangle-up\']"><strong>"U" :</strong> Show/hide all triangle-up ( {{typeMapping[\'triangle-up\']}} ) nodes<br/></span>\r\n        <strong>"L" :</strong> Show/hide all low range group (%33) nodes<br/>\r\n        <strong>"M" :</strong> Show/hide all medium range group (%50) nodes<br/>\r\n        <strong>"H" :</strong> Show/hide all high range group (%66) nodes<br/>\r\n        <strong>"1" :</strong> Show/hide all low range group (%33) links<br/>\r\n        <strong>"2" :</strong> Show/hide all medium range group (%50) links<br/>\r\n        <strong>"3" :</strong> Show/hide all high range group (%66) links\r\n    </fieldset>\r\n</div>\r\n\r\n<div class="d3-container" \r\n    tabindex="0"\r\n    [style.width]="width"\r\n    [style.height]="height"\r\n    [id]="visualizerId"></div>\r\n',styles:[":host{position:relative;display:block}:host.expanded-container{position:inherit!important}:host.expanded-container .d3-container{position:absolute;top:0;left:0;width:100vw!important;height:100vh!important;border:0!important;margin:0!important;z-index:3}:host .legends{position:absolute;right:12px;top:5px;z-index:4}:host .legends a{cursor:pointer;font-weight:700;font-size:1.2rem}:host .legends a span{background-color:#eee;padding:0 3px;width:13px;float:left;height:25px;line-height:25px;border:1px solid #3a3939}:host .legends a .expand{text-align:center;border-left:0;border-right:0}:host .legends a .legend{border-radius:5px 0 0 5px;border-right:0}:host .legends a .help{border-radius:0 5px 5px 0;border-left:0}:host .legends a:hover{color:#fff}:host .legends a:hover span{background-color:#b65200}:host .legends .info{padding:5px;border:1px solid #888;border-radius:5px;position:absolute;right:0;font-size:.7rem;line-height:1rem;box-shadow:1px 1px 3px #bbb;background-color:#fff;width:350px;top:15px}:host .legends .info legend{color:#af8d03;font-size:1rem;font-weight:700}:host .legends .info strong{color:#8f0000;font-size:.8rem;margin-left:20px}:host .d3-container{border:1px solid #633;box-sizing:border-box;border-radius:5px;background-color:#fefefe;margin:5px;overflow:hidden}:host .d3-container ::ng-deep .danger{background-color:#a80505;color:#fff;padding:10px;display:table;width:100%}:host ::ng-deep path.link{fill:none;stroke:#666;stroke-width:1.5px}:host ::ng-deep circle{fill:#ccc;stroke:#fff;stroke-width:1.5px}:host ::ng-deep text{fill:#000;font:10px sans-serif;pointer-events:none}:host ::ng-deep div.tooltip{position:absolute;padding:5px;font:12px sans-serif;background:#cfcfcf;border:1px solid #3a3939;border-radius:4px;pointer-events:none;z-index:5}"]})],e)}(),s=function(){function e(){}return e=o([n.NgModule({imports:[t.CommonModule],declarations:[i],exports:[i],entryComponents:[i],providers:[],schemas:[n.CUSTOM_ELEMENTS_SCHEMA]})],e)}();e.VisualizeItComponent=i,e.VisualizeItModule=s,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=sedeh-visualize-it.umd.min.js.map