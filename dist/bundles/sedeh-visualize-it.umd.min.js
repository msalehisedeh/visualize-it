!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("@sedeh/visualize-it",["exports","@angular/core","@angular/common"],n):n((e.sedeh=e.sedeh||{},e.sedeh["visualize-it"]={}),e.ng.core,e.ng.common)}(this,function(e,n,t){"use strict";function r(r,o){var i,s,a,e,d={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function n(n){return function(e){return function t(e){if(i)throw new TypeError("Generator is already executing.");for(;d;)try{if(i=1,s&&(a=s[2&e[0]?"return":e[0]?"throw":"next"])&&!(a=a.call(s,e[1])).done)return a;switch(s=0,a&&(e=[0,a.value]),e[0]){case 0:case 1:a=e;break;case 4:return d.label++,{value:e[1],done:!1};case 5:d.label++,s=e[1],e=[0];continue;case 7:e=d.ops.pop(),d.trys.pop();continue;default:if(!(a=0<(a=d.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){d=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){d.label=e[1];break}if(6===e[0]&&d.label<a[1]){d.label=a[1],a=e;break}if(a&&d.label<a[2]){d.label=a[2],d.ops.push(e);break}a[2]&&d.ops.pop(),d.trys.pop();continue}e=o.call(r,d)}catch(n){e=[6,n],s=0}finally{i=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([n,e])}}}var o=function(){function e(e){var t=this;this.factory=e,this.showLegend=!1,this.showHelp=!1,this.expanded=!1,this.visualizerId="d3-container",this.gradientsEnabled=!0,this.repealForce=300,this.fixedDistance=60,this.typeMapping={},this.onVisualization=new n.EventEmitter,this.renderer=this.factory.createRenderer(null,null),navigator.platform.toUpperCase().indexOf("MAC")<0&&(document.addEventListener("webkitfullscreenchange",function(e){window.screenTop||window.screenY||t.expand(!1)}),document.addEventListener("mozfullscreenchange",function(e){var n=window;n.fullScreen||n.innerWidth==screen.width&&n.innerHeight==screen.height||t.expand(!1)}),document.addEventListener("MSFullscreenChange",function(e){var n=window;n.fullScreen||n.innerWidth==screen.width&&n.innerHeight==screen.height||t.expand(!1)}))}return e.prototype.triggerEvaluation=function(e){if(e.length){var o={},i=[],s={links:[],nodes:[]};if(this.renderer.selectRootElement("#"+this.visualizerId).innerHTML="",e.map(function(e,n){return o[e.id]=n}),e.map(function(t,r){s.nodes.push({size:t.size?t.size:10,group:t.group?t.group:0,type:t.type&&t.type.length?t.type:"circle",name:t.name,image:t.image,data:t.data?t.data:[]}),t.sources&&t.sources.map(function(e){var n=o[e];n!=undefined?s.links.push({source:n,target:r}):i.push("Missing source node '"+e+"' for node '"+t.id+"'.")}),t.destinations&&t.destinations.map(function(e){var n=o[e];n!=undefined?s.links.push({source:r,target:n}):i.push("Missing destination node '"+e+"' for node '"+t.id+"'.")})}),i.length)this.renderer.selectRootElement("#"+this.visualizerId).innerHTML="<div class='danger'>"+i.join("<br/>")+"</div>";else{var n=this.renderer.selectRootElement("#"+this.visualizerId).parentNode,t={width:window.innerWidth,height:window.innerHeight,offset:{x:n.offsetLeft,y:n.offsetTop},data:s,mapping:this.typeMapping,showTypeOnHover:this.showTypeOnHover,showDirections:this.showDirections,enableTooltip:this.enableTooltip,showCurvedConnections:this.showCurvedConnections,outlineNodes:this.outlineNodes,charge:-1*this.repealForce,fixedDistance:this.fixedDistance,gradientsEnabled:this.gradientsEnabled,targetDiv:"#"+this.visualizerId};window.initiateD3(t)}}else this.renderer.selectRootElement("#"+this.visualizerId).innerHTML="<div class='danger'>Missing data.</div>"},e.prototype.ngOnChanges=function(e){e.data&&setTimeout(this.ngOnInit.bind(this),333)},e.prototype.ngOnInit=function(){this.data instanceof Array||(this.data=[this.data])},e.prototype.ngAfterViewInit=function(){return function e(n,s,a,d){return new(a||(a=Promise))(function(e,t){function r(e){try{i(d.next(e))}catch(n){t(n)}}function o(e){try{i(d["throw"](e))}catch(n){t(n)}}function i(n){n.done?e(n.value):new a(function(e){e(n.value)}).then(r,o)}i((d=d.apply(n,s||[])).next())})}(this,void 0,void 0,function(){var n=this;return r(this,function(e){switch(e.label){case 0:return window.initiateD3?[3,2]:[4,this.loadScript("assets/d3.js","d3js").then(function(){n.triggerEvaluation(n.data)})];case 1:return e.sent(),[3,3];case 2:this.triggerEvaluation(this.data),e.label=3;case 3:return[2]}})})},e.prototype.loadScript=function(r,e){return new Promise(function(e,n){var t=document.createElement("script");t.type="text/javascript",t.src=r,t.onload=e,document.body.appendChild(t)})},e.prototype.expand=function(e){var n=document;if(e){var t=this.renderer.selectRootElement("#"+this.visualizerId).parentNode,r=n.documentElement;r.requestFullscreen?r.requestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullscreen?r.webkitRequestFullscreen():r.msRequestFullscreen&&r.msRequestFullscreen(),t.classList.add("expanded-container"),this.expanded=!0,window.centerVisibility&&window.centerVisibility(0,0)}else{n.exitFullscreen?n.exitFullscreen():n.mozCancelFullScreen?n.mozCancelFullScreen():n.webkitExitFullscreen&&n.webkitExitFullscreen(),(t=this.renderer.selectRootElement("#"+this.visualizerId).parentNode).classList.remove("expanded-container"),this.expanded=!1,window.centerVisibility&&window.centerVisibility(t.offsetLeft,t.offsetTop)}},e.prototype.onchange=function(e){this.triggerEvaluation(e.points)},e.decorators=[{type:n.Component,args:[{selector:"visualize-it",template:'\r\n<div class="legends" *ngIf="enableLegends">\r\n    <a tabindex="0" (click)="showLegend = !showLegend;showHelp = false" title="show Legend"><span class="legend">&#9826;</span></a>\r\n    \r\n    <a *ngIf="!expanded" tabindex="0" (click)="expand(true)" title="show in full screen"><span class="expand">&#9859;</span></a>\r\n    <a *ngIf="expanded" tabindex="0" (click)="expand(false)" title="show in normal screen"><span class="expand">&#9860;</span></a>\r\n    \r\n    <a tabindex="0" (click)="showLegend = false;showHelp = !showHelp" title="show help"><span class="help">?</span></a>\r\n    <fieldset class="info" *ngIf="showLegend">\r\n        <legend>Definitions</legend>\r\n        <b>Relationship types:</b><br/>\r\n        <strong>Dotted line:</strong> Descendancy relationship (example: Children of)<br/>\r\n        <strong>Solid Line:</strong> Origination relationship (example: Parents of)<br/>\r\n        <span *ngIf="showDirections"><strong>Arrow on a line:</strong> Pointing toward the recipient of relationship.<br/></span>\r\n\r\n        <br/><b>Node types:</b><br/>\r\n        <span *ngIf="typeMapping[\'circle\']"><strong>Circle</strong> - {{typeMapping[\'circle\']}}<br/></span>\r\n        <span *ngIf="typeMapping[\'cross\']"><strong>Cross</strong> - {{typeMapping[\'cross\']}}<br/></span>\r\n        <span *ngIf="typeMapping[\'diamond\']"><strong>Diamond</strong> - {{typeMapping[\'diamond\']}}<br/></span>\r\n        <span *ngIf="typeMapping[\'square\']"><strong>Square</strong> - {{typeMapping[\'square\']}}<br/></span>\r\n        <span *ngIf="typeMapping[\'triangle-down\']"><strong>Triangle-down</strong> - {{typeMapping[\'triangle-down\']}}<br/></span>\r\n        <span *ngIf="typeMapping[\'triangle-up\']"><strong>Triangle-up</strong> - {{typeMapping[\'triangle-up\']}}<br/></span>\r\n    </fieldset>\r\n    <fieldset class="info" *ngIf="showHelp">\r\n        <legend>Tips</legend>\r\n        <b>Hover on a node to highlight 1st-order neighbourhood.</b><br/>\r\n        <b>Hold mouse down on a node to fade surroundings.</b><br/>\r\n        <b>Double-click to center node and zoom in.</b><br/>\r\n        <b>Hold SHIFT and Double-click to zoom out.</b><br/><br/>\r\n\r\n        <b>Filter nodes by:</b><br/>\r\n        <strong>"." :</strong> Stop/resume animation<br/>\r\n        <strong>"!" :</strong> Show/hide node category on hover<br/>\r\n        <strong>"#" :</strong> Show/hide link arrow direction<br/>\r\n        <strong>"@" :</strong> Show/hide node names or node category<br/>\r\n        <strong>"T" :</strong> Enable/disable displaying of Tooltip<br/>\r\n        <strong>"Z" :</strong> Do/Don\'t Normalize node sizes on zoom<br/>\r\n        <span *ngIf="typeMapping[\'circle\']"><strong>"C" :</strong> Show/hide all circle ( {{typeMapping[\'circle\']}} ) nodes<br/></span>\r\n        <span *ngIf="typeMapping[\'cross\']"><strong>"X" :</strong> Show/hide all cross ( {{typeMapping[\'cross\']}} ) nodes<br/></span>\r\n        <span *ngIf="typeMapping[\'diamond\']"><strong>"R" :</strong> Show/hide all diamond ( {{typeMapping[\'diamond\']}} ) nodes<br/></span>\r\n        <span *ngIf="typeMapping[\'square\']"><strong>"S" :</strong> Show/hide all square ( {{typeMapping[\'square\']}} ) nodes<br/></span>\r\n        <span *ngIf="typeMapping[\'triangle-down\']"><strong>"D" :</strong> Show/hide all triangle-down ( {{ typeMapping[\'triangle-down\']}} ) nodes<br/></span>\r\n        <span *ngIf="typeMapping[\'triangle-up\']"><strong>"U" :</strong> Show/hide all triangle-up ( {{typeMapping[\'triangle-up\']}} ) nodes<br/></span>\r\n        <strong>"L" :</strong> Show/hide all low range group (%33) nodes<br/>\r\n        <strong>"M" :</strong> Show/hide all medium range group (%50) nodes<br/>\r\n        <strong>"H" :</strong> Show/hide all high range group (%66) nodes<br/>\r\n        <strong>"1" :</strong> Show/hide all low range group (%33) links<br/>\r\n        <strong>"2" :</strong> Show/hide all medium range group (%50) links<br/>\r\n        <strong>"3" :</strong> Show/hide all high range group (%66) links\r\n    </fieldset>\r\n</div>\r\n\r\n<div class="d3-container" \r\n    tabindex="0"\r\n    [style.width]="width"\r\n    [style.height]="height"\r\n    [id]="visualizerId"></div>\r\n',styles:[":host{position:relative;display:block}:host.expanded-container{position:inherit!important}:host.expanded-container .d3-container{position:absolute;top:0;left:0;width:100vw!important;height:100vh!important;border:0!important;margin:0!important;z-index:3}:host .legends{position:absolute;right:12px;top:5px;z-index:4}:host .legends a{cursor:pointer;font-weight:700;font-size:1.2rem}:host .legends a span{background-color:#eee;padding:0 3px;width:13px;float:left;height:25px;line-height:25px;border:1px solid #3a3939}:host .legends a .expand{text-align:center;border-left:0;border-right:0}:host .legends a .legend{border-radius:5px 0 0 5px;border-right:0}:host .legends a .help{border-radius:0 5px 5px 0;border-left:0}:host .legends a:hover{color:#fff}:host .legends a:hover span{background-color:#b65200}:host .legends .info{padding:5px;border:1px solid #888;border-radius:5px;position:absolute;right:0;font-size:.7rem;line-height:1rem;box-shadow:1px 1px 3px #bbb;background-color:#fff;width:350px;top:15px}:host .legends .info legend{color:#af8d03;font-size:1rem;font-weight:700}:host .legends .info strong{color:#8f0000;font-size:.8rem;margin-left:20px}:host .d3-container{border:1px solid #633;box-sizing:border-box;border-radius:5px;background-color:#fefefe;margin:5px;overflow:hidden}:host .d3-container ::ng-deep .danger{background-color:#a80505;color:#fff;padding:10px;display:table;width:100%}:host ::ng-deep path.link{fill:none;stroke:#666;stroke-width:1.5px}:host ::ng-deep circle{fill:#ccc;stroke:#fff;stroke-width:1.5px}:host ::ng-deep text{fill:#000;font:10px sans-serif;pointer-events:none}:host ::ng-deep div.tooltip{position:absolute;padding:5px;font:12px sans-serif;background:#cfcfcf;border:1px solid #3a3939;border-radius:4px;pointer-events:none;z-index:5}"]}]}],e.ctorParameters=function(){return[{type:n.RendererFactory2}]},e.propDecorators={showCurvedConnections:[{type:n.Input,args:["showCurvedConnections"]}],visualizerId:[{type:n.Input,args:["visualizerId"]}],enableTooltip:[{type:n.Input,args:["enableTooltip"]}],gradientsEnabled:[{type:n.Input,args:["gradientsEnabled"]}],repealForce:[{type:n.Input,args:["repealForce"]}],fixedDistance:[{type:n.Input,args:["fixedDistance"]}],outlineNodes:[{type:n.Input,args:["outlineNodes"]}],enableLegends:[{type:n.Input,args:["enableLegends"]}],showTypeOnHover:[{type:n.Input,args:["showTypeOnHover"]}],showDirections:[{type:n.Input,args:["showDirections"]}],data:[{type:n.Input,args:["data"]}],typeMapping:[{type:n.Input,args:["typeMapping"]}],width:[{type:n.Input,args:["width"]}],height:[{type:n.Input,args:["height"]}],onVisualization:[{type:n.Output,args:["onVisualization"]}]},e}(),i=function(){function e(){}return e.decorators=[{type:n.NgModule,args:[{imports:[t.CommonModule],declarations:[o],exports:[o],entryComponents:[o],providers:[],schemas:[n.CUSTOM_ELEMENTS_SCHEMA]}]}],e}();e.VisualizeItComponent=o,e.VisualizeItModule=i,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=sedeh-visualize-it.umd.min.js.map