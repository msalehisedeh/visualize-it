!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common"],e):e(n["visualize-it"]={},n.ng.core,n.ng.common)}(this,function(n,e,t){"use strict";function o(n,e){var t,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),"throw":a(1),"return":a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,o&&(i=o[2&r[0]?"return":r[0]?"throw":"next"])&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[0,i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(n,s)}catch(a){r=[6,a],o=0}finally{t=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}var i=function(){function n(n){var t=this;this.el=n,this.showLegend=!1,this.showHelp=!1,this.expanded=!1,this.typeMapping={},this.onVisualization=new e.EventEmitter,document.addEventListener("webkitfullscreenchange",function(n){window.screenTop||window.screenY||t.expand(!1)}),document.addEventListener("mozfullscreenchange",function(n){var e=window;e.fullScreen||e.innerWidth==screen.width&&e.innerHeight==screen.height||t.expand(!1)}),document.addEventListener("MSFullscreenChange",function(n){var e=window;e.fullScreen||e.innerWidth==screen.width&&e.innerHeight==screen.height||t.expand(!1)})}return n.prototype.triggerEvaluation=function(n){if(n.length){var e={},t=[],o={links:[],nodes:[]};if(this.d3Container.nativeElement.innerHTML="",n.map(function(n,t){return e[n.id]=t}),n.map(function(n,i){o.nodes.push({size:n.size?n.size:10,group:n.group?n.group:0,type:n.type&&n.type.length?n.type:"circle",name:n.name,data:n.data?n.data:[]}),n.sources&&n.sources.map(function(r){var s=e[r];s!=undefined?o.links.push({source:s,target:i}):t.push("Missing source node '"+r+"' for node '"+n.id+"'.")}),n.destinations&&n.destinations.map(function(r){var s=e[r];s!=undefined?o.links.push({source:i,target:s}):t.push("Missing destination node '"+r+"' for node '"+n.id+"'.")})}),t.length)this.d3Container.nativeElement.innerHTML="<div class='danger'>"+t.join("<br/>")+"</div>";else{var i={x:this.el.nativeElement.offsetLeft,y:this.el.nativeElement.offsetTop};window.initiateD3(window.innerWidth,window.innerHeight,i,o,this.typeMapping,this.showTypeOnHover,this.showDirections,this.enableTooltip,"#d3-container")}}else this.d3Container.nativeElement.innerHTML="<div class='danger'>Missing data.</div>"},n.prototype.ngOnChanges=function(n){n.data&&setTimeout(this.ngOnInit.bind(this),333)},n.prototype.ngOnInit=function(){this.data instanceof Array||(this.data=[this.data])},n.prototype.ngAfterViewInit=function(){return n=this,e=void 0,i=function(){var n=this;return o(this,function(e){switch(e.label){case 0:return window.initiateD3?[3,2]:[4,this.loadScript("assets/d3.js","d3js").then(function(){n.triggerEvaluation(n.data)})];case 1:return e.sent(),[3,3];case 2:this.triggerEvaluation(this.data),e.label=3;case 3:return[2]}})},new((t=void 0)||(t=Promise))(function(o,r){function s(n){try{p(i.next(n))}catch(e){r(e)}}function a(n){try{p(i["throw"](n))}catch(e){r(e)}}function p(n){n.done?o(n.value):new t(function(e){e(n.value)}).then(s,a)}p((i=i.apply(n,e||[])).next())});var n,e,t,i},n.prototype.loadScript=function(n,e){return new Promise(function(e,t){var o=document.createElement("script");o.type="text/javascript",o.src=n,o.onload=e,document.body.appendChild(o)})},n.prototype.expand=function(n){var e=document;if(n){var t=e.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),this.el.nativeElement.classList.add("expanded-container"),this.expanded=!0,window.centerVisibility&&window.centerVisibility(0,0)}else e.exitFullscreen?e.exitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen&&e.webkitExitFullscreen(),this.el.nativeElement.classList.remove("expanded-container"),this.expanded=!1,window.centerVisibility&&window.centerVisibility(this.el.nativeElement.offsetLeft,this.el.nativeElement.offsetTop)},n.prototype.onchange=function(n){this.triggerEvaluation(n.points)},n}();i.decorators=[{type:e.Component,args:[{selector:"visualize-it",template:'\n<div class="legends" *ngIf="enableLegends">\n    <a tabindex="0" (click)="showLegend = !showLegend;showHelp = false" title="show Legend"><span class="legend">&#9826;</span></a>\n    <a *ngIf="!expanded" tabindex="0" (click)="expand(true)" title="show in full screen"><span class="expand">&#9859;</span></a>\n    <a *ngIf="expanded" tabindex="0" (click)="expand(false)" title="show in normal screen"><span class="expand">&#9860;</span></a>\n    <a tabindex="0" (click)="showLegend = false;showHelp = !showHelp" title="show help"><span class="help">?</span></a>\n    <fieldset class="info" *ngIf="showLegend">\n        <legend>Definitions</legend>\n        <b>Link types:</b><br/>\n        <strong>Dotted line:</strong> Destination of a Node<br/>\n        <strong>Line:</strong> Source of a Node<br/>\n        <span *ngIf="showDirections"><strong>Line Arrow:</strong> Pointing toward the destination.<br/></span>\n        <br/><b>Node types:</b><br/>\n        <span *ngIf="typeMapping[\'circle\']"><strong>Circle</strong> - {{typeMapping[\'circle\']}}<br/></span>\n        <span *ngIf="typeMapping[\'cross\']"><strong>Cross</strong> - {{typeMapping[\'cross\']}}<br/></span>\n        <span *ngIf="typeMapping[\'diamond\']"><strong>Diamond</strong> - {{typeMapping[\'diamond\']}}<br/></span>\n        <span *ngIf="typeMapping[\'square\']"><strong>Square</strong> - {{typeMapping[\'square\']}}<br/></span>\n        <span *ngIf="typeMapping[\'triangle-down\']"><strong>Triangle-down</strong> - {{typeMapping[\'triangle-down\']}}<br/></span>\n        <span *ngIf="typeMapping[\'triangle-up\']"><strong>Triangle-up</strong> - {{typeMapping[\'triangle-up\']}}<br/></span>\n    </fieldset>\n    <fieldset class="info" *ngIf="showHelp">\n        <legend>Tips</legend>\n        <b>Hover on a node to highlight 1st-order neighbourhood.</b><br/>\n        <b>Hold mouse down on a node to fade surroundings.</b><br/>\n        <b>Double-click to center node and zoom in.</b><br/>\n        <b>Hold SHIFT and Double-click to zoom out.</b><br/><br/>\n        <b>Filter nodes by:</b><br/>\n        <strong>"." :</strong> Stop/resume animation<br/>\n        <strong>"!" :</strong> Show/hide node category on hover<br/>\n        <strong>"#" :</strong> Show/hide link arrow direction<br/>\n        <strong>"@" :</strong> Show/hide node names or node category<br/>\n        <strong>"T" :</strong> Enable/disable displaying of Tooltip<br/>\n        <strong>"Z" :</strong> Do/Don\'t Normalize node sizes on zoom<br/>\n        <span *ngIf="typeMapping[\'circle\']"><strong>"C" :</strong> Show/hide all circle ( {{typeMapping[\'circle\']}} ) nodes<br/></span>\n        <span *ngIf="typeMapping[\'cross\']"><strong>"X" :</strong> Show/hide all cross ( {{typeMapping[\'cross\']}} ) nodes<br/></span>\n        <span *ngIf="typeMapping[\'diamond\']"><strong>"R" :</strong> Show/hide all diamond ( {{typeMapping[\'diamond\']}} ) nodes<br/></span>\n        <span *ngIf="typeMapping[\'square\']"><strong>"S" :</strong> Show/hide all square ( {{typeMapping[\'square\']}} ) nodes<br/></span>\n        <span *ngIf="typeMapping[\'triangle-down\']"><strong>"D" :</strong> Show/hide all triangle-down ( {{ typeMapping[\'triangle-down\']}} ) nodes<br/></span>\n        <span *ngIf="typeMapping[\'triangle-up\']"><strong>"U" :</strong> Show/hide all triangle-up ( {{typeMapping[\'triangle-up\']}} ) nodes<br/></span>\n        <strong>"L" :</strong> Show/hide all low range group (%33) nodes<br/>\n        <strong>"M" :</strong> Show/hide all medium range group (%50) nodes<br/>\n        <strong>"H" :</strong> Show/hide all high range group (%66) nodes<br/>\n        <strong>"1" :</strong> Show/hide all low range group (%33) links<br/>\n        <strong>"2" :</strong> Show/hide all medium range group (%50) links<br/>\n        <strong>"3" :</strong> Show/hide all high range group (%66) links\n    </fieldset>\n</div>\n<div class="d3-container"\n    tabindex="0"\n    [style.width]="width"\n    [style.height]="height"\n    id="d3-container" #d3Container></div>\n',styles:[":host{\n  position:relative;\n  display:block; }\n  :host.expanded-container{\n    position:inherit !important; }\n    :host.expanded-container .d3-container{\n      position:absolute;\n      top:0;\n      left:0;\n      width:100vw !important;\n      height:100vh !important;\n      border:0 !important;\n      margin:0 !important;\n      z-index:3; }\n  :host .legends{\n    position:absolute;\n    right:12px;\n    top:5px;\n    z-index:4; }\n    :host .legends a{\n      cursor:pointer;\n      font-weight:bold;\n      font-size:1.2rem; }\n      :host .legends a span{\n        background-color:#eee;\n        padding:0 3px;\n        width:13px;\n        float:left;\n        height:25px;\n        line-height:25px;\n        border:1px solid #3a3939; }\n      :host .legends a .expand{\n        text-align:center;\n        border-left:0;\n        border-right:0; }\n      :host .legends a .legend{\n        border-radius:5px 0 0 5px;\n        border-right:0; }\n      :host .legends a .help{\n        border-radius:0 5px 5px 0;\n        border-left:0; }\n      :host .legends a:hover{\n        color:#fff; }\n        :host .legends a:hover span{\n          background-color:#b65200; }\n    :host .legends .info{\n      padding:5px;\n      border:1px solid #888;\n      border-radius:5px;\n      position:absolute;\n      right:0px;\n      font-size:0.7rem;\n      line-height:1rem;\n      -webkit-box-shadow:1px 1px 3px #bbb;\n              box-shadow:1px 1px 3px #bbb;\n      background-color:#fff;\n      width:350px;\n      top:15px; }\n      :host .legends .info legend{\n        color:#af8d03;\n        font-size:1rem;\n        font-weight:bold; }\n      :host .legends .info strong{\n        color:#8f0000;\n        font-size:0.8rem;\n        margin-left:20px; }\n  :host #d3-container{\n    border:1px solid #633;\n    -webkit-box-sizing:border-box;\n            box-sizing:border-box;\n    border-radius:5px;\n    background-color:#fefefe;\n    margin:5px;\n    overflow:hidden; }\n    :host #d3-container ::ng-deep .danger{\n      background-color:#a80505;\n      color:#fff;\n      padding:10px;\n      display:table;\n      width:100%; }\n  :host ::ng-deep path.link{\n    fill:none;\n    stroke:#666;\n    stroke-width:1.5px; }\n  :host ::ng-deep circle{\n    fill:#ccc;\n    stroke:#fff;\n    stroke-width:1.5px; }\n  :host ::ng-deep text{\n    fill:#000;\n    font:10px sans-serif;\n    pointer-events:none; }\n  :host ::ng-deep div.tooltip{\n    position:absolute;\n    padding:5px;\n    font:12px sans-serif;\n    background:#cfcfcf;\n    border:1px solid #3a3939;\n    border-radius:4px;\n    pointer-events:none;\n    z-index:5; }\n"]}]}],i.ctorParameters=function(){return[{type:e.ElementRef}]},i.propDecorators={enableTooltip:[{type:e.Input,args:["enableTooltip"]}],enableLegends:[{type:e.Input,args:["enableLegends"]}],showTypeOnHover:[{type:e.Input,args:["showTypeOnHover"]}],showDirections:[{type:e.Input,args:["showDirections"]}],data:[{type:e.Input,args:["data"]}],typeMapping:[{type:e.Input,args:["typeMapping"]}],width:[{type:e.Input,args:["width"]}],height:[{type:e.Input,args:["height"]}],onVisualization:[{type:e.Output,args:["onVisualization"]}],d3Container:[{type:e.ViewChild,args:["d3Container"]}]};var r=function(){return function(){}}();r.decorators=[{type:e.NgModule,args:[{imports:[t.CommonModule],declarations:[i],exports:[i],entryComponents:[i],providers:[],schemas:[e.CUSTOM_ELEMENTS_SCHEMA]}]}],r.ctorParameters=function(){return[]},n.VisualizeItComponent=i,n.VisualizeItModule=r,Object.defineProperty(n,"__esModule",{value:!0})});
//# sourceMappingURL=visualize-it.umd.min.js.map
